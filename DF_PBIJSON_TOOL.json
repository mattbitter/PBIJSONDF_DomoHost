{"name":"DF_DB_Product","description":"","version":"1.0","culture":"en-US","modifiedTime":"2022-03-29T14:21:13.1477227+00:00","pbi:mashup":{"fastCombine":false,"allowNativeQueries":false,"queriesMetadata":{"Product_RM_T":{"queryId":"c623a120-eb7a-4052-9a98-792462fad750","queryName":"Product_RM_T","loadEnabled":true},"Product_RM":{"queryId":"3fff06ac-66c2-4050-8124-af6de984ebb3","queryName":"Product_RM"},"Product_DP":{"queryId":"01b5015e-59a5-43a1-b8dd-3fd00a3f40ef","queryName":"Product_DP"},"Product":{"queryId":"cbb5392d-b028-4945-aeb0-ce23c898c522","queryName":"Product"},"Product_SHIP":{"queryId":"24a611f7-4530-4b26-af23-eed5c4cce57e","queryName":"Product_SHIP"},"PARTY_CALENDAR_WEEK":{"queryId":"0bc34bea-5c07-4956-9fbc-b1092d02e237","queryName":"PARTY_CALENDAR_WEEK","queryGroupId":"ca8ed665-e229-4757-abd6-917e26555edb"},"ERP_PRODUCT":{"queryId":"8badc324-1772-48d4-857a-2258e4b5722a","queryName":"ERP_PRODUCT","queryGroupId":"ca8ed665-e229-4757-abd6-917e26555edb"},"ERP_REGIONAL":{"queryId":"aa76d585-c5c2-4e41-b2c4-7e83075b7f65","queryName":"ERP_REGIONAL","queryGroupId":"ca8ed665-e229-4757-abd6-917e26555edb"},"Product_DP_SRC":{"queryId":"291cc401-cd42-4bbc-9e34-4bdd5dff4e56","queryName":"Product_DP_SRC","queryGroupId":"ca8ed665-e229-4757-abd6-917e26555edb"},"Product_RM_SRC":{"queryId":"62266755-4018-42a6-9de1-813a823a0160","queryName":"Product_RM_SRC","queryGroupId":"ca8ed665-e229-4757-abd6-917e26555edb"}},"document":"section Section1;\r\nshared Product_RM_T = let\r\n  Source = Product_RM_SRC,\r\n  #\"Added Custom\" = Table.AddColumn(Source, \"MergeTag\", each if [CLOSING_STATUS] = 0 then [FEATURE_ID]&Text.From([FEATURE_START_DATE])&[SKU_ERP]&\"rejected\" else [FEATURE_ID]&Text.From([FEATURE_START_DATE])&[SKU_ERP]),\r\n  #\"Duplicated Column\" = Table.DuplicateColumn(#\"Added Custom\", \"FEATURE_START_DATE\", \"Feature Start Date - Copy\"),\r\n  #\"Changed Type\" = Table.TransformColumnTypes(#\"Duplicated Column\", {{\"Feature Start Date - Copy\", type date}}),\r\n  #\"Split Column by Character Transition\" = Table.SplitColumn(Table.TransformColumnTypes(#\"Changed Type\", {{\"Feature Start Date - Copy\", type text}}, \"en-US\"), \"Feature Start Date - Copy\", Splitter.SplitTextByCharacterTransition({\"0\"..\"9\"}, (c) => not List.Contains({\"0\"..\"9\"}, c)), {\"Feature Start Date - Copy.1\", \"Feature Start Date - Copy.2\", \"Feature Start Date - Copy.3\"}),\r\n  #\"Split Column by Positions\" = Table.SplitColumn(#\"Split Column by Character Transition\", \"Feature Start Date - Copy.3\", Splitter.SplitTextByPositions({1}), {\"Year\"}),\r\n  #\"Removed Columns\" = Table.RemoveColumns(#\"Split Column by Positions\", {\"Feature Start Date - Copy.1\", \"Feature Start Date - Copy.2\"}),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Removed Columns\", {{\"MergeTag\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"MergeTag\", null}}),\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Replace errors\", {\"CUSTOMER\"}, ERP_REGIONAL, {\"ERP Regional Customer\"}, \"ERP_REGIONAL\", JoinKind.LeftOuter),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Merged queries\", {{\"Year\", Int64.Type}}),\r\n  #\"Expanded ERP_REGIONAL\" = Table.ExpandTableColumn(#\"Changed column type\", \"ERP_REGIONAL\", {\"ERP Distribution Channel\"}, {\"ERP Distribution Channel\"})\r\nin\r\n  #\"Expanded ERP_REGIONAL\";\r\nshared Product_RM = let\r\n  Source = Product_RM_T,\r\n  #\"Replaced Value\" = Table.ReplaceValue(Source, \"Retail\", \"RE\", Replacer.ReplaceText, {\"ERP Distribution Channel\"}),\r\n  #\"Sorted Rows\" = Table.Sort(#\"Replaced Value\", {{\"DATE_SUBMITTED\", Order.Descending}}),\r\n  #\"Removed Duplicates1\" = Table.Distinct(#\"Sorted Rows\", {\"SKU_ERP\", \"Year\", \"BANNER\", \"SHIP_WEEK\"}),\r\n  #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Duplicates1\", {{\"SKU_LEGACY\", \"Sku\"}, {\"CUSTOMER\", \"Regional Customer\"}, {\"CUSTOMER_ID\", \"Demand Group\"}, {\"AD_MENTION\", \"Feature Type\"}}),\r\n  #\"Added Custom1\" = Table.AddColumn(#\"Renamed Columns\", \"SOURCE\", each \"Product\"),\r\n  #\"Renamed Columns1\" = Table.RenameColumns(#\"Added Custom1\", {{\"FEATURE_ID\", \"Feature ID\"}, {\"SHIP_WEEK\", \"Week\"}}),\r\n  #\"Added Custom2\" = Table.AddColumn(#\"Renamed Columns1\", \"Status\", each \"Confirmed\"),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Added Custom2\", {{\"SOURCE\", type text}, {\"Status\", type text}, {\"MergeTag\", type text}}),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Changed column type\", {{\"CBT\", \"ERP Sales Office\"}, {\"SKU_ERP\", \"ERP Material ID\"}, {\"Sku\", \"ERP Legacy Material ID\"}, {\"Regional Customer\", \"ERP Regional Customer\"}, {\"PRODUCT_DESCRIPTION\", \"ERP Material\"}, {\"PRODUCT_GROUP\", \"ERP Segment\"}, {\"Demand Group\", \"ERP Regional Customer ID\"}, {\"BANNER\", \"Product Banner\"}, {\"MARKET\", \"ERP Market\"}, {\"DEPARTMENT\", \"ERP Department\"}, {\"CATEGORY\", \"ERP Category\"}, {\"ACCOUNT_MANAGER\", \"Account Manager\"}, {\"Feature ID\", \"Feature ID\"}, {\"UNITS_PER_CASE\", \"ERP Units/Case\"}, {\"INSERT_DATE\", \"Insert Date\"}, {\"MergeTag\", \"Merge Tag\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared Product_DP = let\r\n  Source = Product_DP_SRC,\r\n  #\"Filtered Rows\" = Table.SelectRows(Source, each [STATUS] = \"Confirmed\" and [LIFT_FORECAST_CS] <> 0),\r\n  #\"Added Custom\" = Table.AddColumn(#\"Filtered Rows\", \"Merge Tag\", each [ID_REF] & Text.From([FEATURE_START_DATE]) & [SKU_ERP]),\r\n  #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"SOURCE\", each \"Tracker\"),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Added Custom1\", {{\"BANNER\", \"Product Banner\"}, {\"BANNER_ID\", \"Product Banner ID\"}, {\"CHANNEL\", \"ERP Distribution Channel\"}, {\"CBT\", \"ERP Sales Office\"}, {\"CBT_REGIONAL\", \"ERP Regional Sales Office\"}, {\"SALES_REGION\", \"ERP FS Sales Region\"}, {\"REGIONAL_CUSTOMER\", \"ERP Regional Customer\"}, {\"DEMAND_GROUP\", \"ERP Regional Customer ID\"}, {\"MARKET\", \"ERP Market\"}, {\"DEPARTMENT\", \"ERP Department\"}, {\"PRODUCT_DESCRIPTION\", \"ERP Material\"}, {\"CATEGORY\", \"ERP Category\"}, {\"PRODUCT_GROUP\", \"ERP Segment\"}, {\"BRAND\", \"ERP Brand\"}, {\"SKU_ERP\", \"ERP Material ID\"}, {\"SKU\", \"ERP Legacy Material ID\"}, {\"ID_REF\", \"ID Ref\"}, {\"YEAR\", \"Year\"}, {\"WEEK\", \"Week\"}, {\"ACCOUNT_MANAGER\", \"Account Manager\"}, {\"FEATURE_ID\", \"Feature ID\"}, {\"UNITS_PER_CASE\", \"ERP Units/Case\"}, {\"STATUS\", \"Status\"}}),\r\n  #\"Appended Query\" = Table.Combine({#\"Renamed columns\", Product_RM}),\r\n  #\"Merged Queries\" = Table.NestedJoin(#\"Appended Query\", {\"Product Banner\", \"Year\", \"Week\", \"ERP Material ID\"}, Product_RM, {\"Product Banner\", \"Year\", \"Week\", \"ERP Material ID\"}, \"Product RM\", JoinKind.LeftOuter),\r\n  #\"Expanded Product rv\" = Table.ExpandTableColumn(#\"Merged Queries\", \"Product RM\", {\"FSP\"}, {\"FSP.1\"}),\r\n  #\"Added Conditional Column\" = Table.AddColumn(#\"Expanded Product rv\", \"FSP F\", each if [FSP.1] = null then [FSP] else [FSP.1]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Added Conditional Column\", {{\"Year\", Int64.Type}, {\"Merge Tag\", type text}, {\"SOURCE\", type text}, {\"FSP F\", type text}}),\r\n  #\"Transform columns\" = Table.TransformColumnTypes(#\"Changed column type\", {{\"Week\", type text}}),\r\n  #\"Replace errors\" = Table.ReplaceErrorValues(#\"Transform columns\", {{\"Week\", null}}),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Replace errors\", {{\"PRODUCTION_LINE\", \"ERP Production Line\"}})\r\nin\r\n  #\"Renamed columns 1\";\r\nshared Product = let\r\n  Source = Product_DP,\r\n  #\"Filtered Rows2\" = Table.SelectRows(Source, each [ERP Distribution Channel] = \"RE\"),\r\n  #\"Renamed Columns4\" = Table.RenameColumns(#\"Filtered Rows2\", {{\"Year\", \"Ship Year\"}, {\"Week\", \"Ship Week\"}, {\"Feature Type\", \"Ad Mention\"}}),\r\n  #\"Added Conditional Column2\" = Table.AddColumn(#\"Renamed Columns4\", \"Regular Invoice Cost/Unit\", each if [PER_UOM_FOR_INVOICE_COST] = \"/case\" then Value.Divide([REGULAR_INVOICE_COST],[#\"ERP Units/Case\"]) else if [PER_UOM_FOR_INVOICE_COST] = \"/kg\" then Value.Divide(Value.Multiply([REGULAR_INVOICE_COST],[KILOS_PER_CASE]),[#\"ERP Units/Case\"]) else [REGULAR_INVOICE_COST]),\r\n  #\"Added Conditional Column3\" = Table.AddColumn(#\"Added Conditional Column2\", \"Feature Invoice Cost/Unit\", each if [PER_UOM_FOR_INVOICE_COST] = \"/case\" then Value.Divide([FEATURE_INVOICE_COST],[#\"ERP Units/Case\"]) else if [PER_UOM_FOR_INVOICE_COST] = \"/kg\" then Value.Divide(Value.Multiply([FEATURE_INVOICE_COST],[KILOS_PER_CASE]),[#\"ERP Units/Case\"]) else [FEATURE_INVOICE_COST]),\r\n  #\"Changed Type12\" = Table.TransformColumnTypes(#\"Added Conditional Column3\", {{\"Regular Invoice Cost/Unit\", Currency.Type}, {\"Feature Invoice Cost/Unit\", Currency.Type}}),\r\n  #\"Changed Type7\" = Table.TransformColumnTypes(#\"Changed Type12\", {{\"Ship Year\", Int64.Type}, {\"Ship Week\", Int64.Type}}),\r\n  #\"Merged Queries1\" = Table.NestedJoin(#\"Changed Type7\", {\"Ship Year\", \"Ship Week\"}, PARTY_CALENDAR_WEEK, {\"YEAR_NUMBER\", \"WEEK_NUMBER\"}, \"PARTY_CALENDAR_WEEK\", JoinKind.LeftOuter),\r\n  #\"Expanded PARTY_CALENDAR_WEEK\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"PARTY_CALENDAR_WEEK\", {\"WEEK_START_DATE\"}, {\"WEEK_START_DATE\"}),\r\n  #\"Renamed Columns2\" = Table.RenameColumns(#\"Expanded PARTY_CALENDAR_WEEK\", {{\"WEEK_START_DATE\", \"True Shipping Start Date\"}}),\r\n  #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns2\", \"FSC/Unit\", each if [PER_UOM_FOR_INVOICE_COST]=\"/case\" then [FEATURE_INVOICE_COST]/[#\"ERP Units/Case\"]else [FEATURE_INVOICE_COST]),\r\n  #\"Changed Type8\" = Table.TransformColumnTypes(#\"Added Custom\", {{\"True Shipping Start Date\", type datetime}}),\r\n  #\"Added Conditional Column1\" = Table.AddColumn(#\"Changed Type8\", \"True Shipping Start Date2\", each if [True Shipping Start Date] = null then [Shipping Start Date] else [True Shipping Start Date]),\r\n  #\"Changed Type9\" = Table.TransformColumnTypes(#\"Added Conditional Column1\", {{\"True Shipping Start Date2\", type datetime}}),\r\n  #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type9\", {\"True Shipping Start Date\"}),\r\n  #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns\", {{\"True Shipping Start Date2\", \"True Shipping Start Date\"}}),\r\n  #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns3\", {{\"REGULAR_INVOICE_COST\", Currency.Type}, {\"FEATURE_INVOICE_COST\", Currency.Type}, {\"FSP\", Currency.Type}, {\"FSC/Unit\", Currency.Type}}),\r\n  #\"Changed Type1\" = Table.TransformColumnTypes(#\"Changed Type\", {{\"DATE_SUBMITTED\", type date}, {\"SHIPPING_START_DATE\", type date}, {\"FEATURE_START_DATE\", type date}, {\"FEATURE_END_DATE\", type date}, {\"True Shipping Start Date\", type date}}),\r\n  #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type1\", \"True Start Date\", each [FEATURE_START_DATE]),\r\n  #\"Changed Type4\" = Table.TransformColumnTypes(#\"Added Conditional Column\", {{\"True Start Date\", type date}}),\r\n  #\"Inserted Date Subtraction\" = Table.AddColumn(#\"Changed Type4\", \"DateDifference\", each Duration.Days([FEATURE_END_DATE] - [True Start Date]), Int64.Type),\r\n  #\"Added Custom1\" = Table.AddColumn(#\"Inserted Date Subtraction\", \"Dates\", each List.Dates([True Start Date],[DateDifference]+1,#duration(1,0,0,0))),\r\n  #\"Expanded Dates\" = Table.ExpandListColumn(#\"Added Custom1\", \"Dates\"),\r\n  #\"Added Custom2\" = Table.AddColumn(#\"Expanded Dates\", \"Week\", each Date.Year([Dates])*100+Date.WeekOfYear([Dates])),\r\n  #\"Renamed Columns5\" = Table.RenameColumns(#\"Added Custom2\", {{\"Feature ID\", \"FeatureID\"}}),\r\n  #\"Filtered Rows3\" = Table.SelectRows(#\"Renamed Columns5\", each [FeatureID] <> null and [FeatureID] <> \"\"),\r\n  #\"Uppercased Text\" = Table.TransformColumns(#\"Filtered Rows3\",{{\"Product Banner\", Text.Upper}, {\"ERP Sales Office\", Text.Upper}}),\r\n  #\"Uppercased Text1\" = Table.TransformColumns(#\"Uppercased Text\",{{\"Product Banner\", Text.Upper, type text}}),\r\n  #\"Changed Type2\" = Table.TransformColumnTypes(#\"Uppercased Text1\", {{\"Week\", type text}}),\r\n  #\"Added Custom4\" = Table.AddColumn(#\"Changed Type2\", \"Product Key\", each [Product Banner] & \"-\" & [ERP Material ID] & \"-\" & [Week]),\r\n  #\"Changed Type3\" = Table.TransformColumnTypes(#\"Added Custom4\", {{\"Week\", Int64.Type}}),\r\n  #\"Changed Type5\" = Table.TransformColumnTypes(#\"Changed Type3\", {{\"Product Key\", type text}}),\r\n  #\"Removed Columns2\" = Table.RemoveColumns(#\"Changed Type5\", {\"ENTERED_BY\", \"ERP Material\", \"Account Manager\", \"ERP Brand\", \"ERP Market\", \"ERP Department\", \"ERP Category\", \"ERP Segment\", \"REVISED_BY\"}),\r\n  #\"Removed Columns4\" = Table.RemoveColumns(#\"Removed Columns2\", {\"ERP Sales Office\", \"Dates\", \"ERP Distribution Channel\", \"Ship Year\", \"Ship Week\"}),\r\n  #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns4\", {{\"ERP Units/Case\", \"Units Per Case\"}}),\r\n  #\"Inserted Division\" = Table.AddColumn(#\"Renamed Columns1\", \"Duration\", each Number.Round([DateDifference] / 7), type number),\r\n  #\"Added Custom3\" = Table.AddColumn(#\"Inserted Division\", \"Product Week Type\", each \"FEATURE\"),\r\n  #\"Changed Type10\" = Table.TransformColumnTypes(#\"Added Custom3\", {{\"Product Week Type\", type text}}),\r\n  #\"Appended Query1\" = Table.Combine({#\"Changed Type10\", Product_SHIP}),\r\n  #\"Sorted Rows1\" = Table.Sort(#\"Appended Query1\", {{\"DATE_SUBMITTED\", Order.Descending}}),\r\n  #\"Filtered Rows5\" = Table.SelectRows(#\"Sorted Rows1\", each [Status] = \"Confirmed\"),\r\n  #\"Merged Queries\" = Table.NestedJoin(#\"Filtered Rows5\", {\"ERP Material ID\"}, ERP_PRODUCT, {\"ERP Material ID\"}, \"ERP_PRODUCT\", JoinKind.LeftOuter),\r\n  #\"Renamed Columns6\" = Table.RenameColumns(#\"Merged Queries\", {{\"Net Weight\", \"Product Net Weight\"}}),\r\n  #\"Expanded ERP_PRODUCT\" = Table.ExpandTableColumn(#\"Renamed Columns6\", \"ERP_PRODUCT\", {\"NET_WEIGHT\", \"PROD_HIER\"}, {\"Net Weight\", \"ERP_PRODUCT.Product hierarchy\"}),\r\n  #\"Removed Duplicates1\" = Table.Distinct(#\"Expanded ERP_PRODUCT\", {\"Product Key\"}),\r\n  #\"Filtered Rows1\" = Table.SelectRows(#\"Removed Duplicates1\", each [Product Key] <> null and [Product Key] <> \"\"),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Filtered Rows1\", {\"DATE_SUBMITTED\", \"DATE_ENTERED\", \"LATE_FLAG\", \"LAST_REVISITED_DATE\", \"QUARTER\", \"PERIOD\", \"Product Banner ID\", \"BARE_ID\", \"ERP Regional Customer ID\", \"CUSTOMER_DEMAND_TEAM\", \"ERP Regional Customer\", \"ERP FS Sales Region\", \"MINOR_CLASS\", \"LOCATION\", \"EST_TOTAL_VOLUME_FOR_REG_CUSTOMER_IN_UOM\", \"PERCENT_SOLD_TO_BANNER\", \"LIFT_FORECAST_CS\", \"LIFT_FORECAST_EA\", \"LIFT_FORECAST_KG\", \"LIFT_HISTORY_CS\", \"LIFT_HISTORY_EA\", \"LIFT_HISTORY_KG\", \"CURRENT_FORECAST\", \"PREVIOUS_FORECAST\", \"ORIGINAL_FORECAST\", \"UPLOAD_FLAG\", \"ZERO_LOCATION\", \"REVISION_COUNT\", \"REVIOSION_LEAD_TIME_DAYS\", \"LATE_REVISION_FLAG\", \"NET_CHANGE\", \"GL_REASON_CODE\", \"EST_TOTAL_AMT\", \"LIST_PRICE_AMT_PER_CS_OR_AMT_PER_KG\", \"KG_CURRENT_FORECAST\", \"KG_PREVIOUS_FORECAST\", \"KG_ORIGINAL_FORECAST\", \"AO_REVISION_WINDOW\", \"AO_FCST_CHANGE\", \"FEATURE_LEVEL\", \"TOTAL_INC_VOLUME\", \"LIFT_FLAG\", \"ORIGINAL_FORECAST_FLAG\", \"FEATURE_ID_SHORT\", \"FAP\", \"REBOOK_CANCEL\", \"REBOOK_ENTRY\", \"PURGE_FLAG\", \"ERP Production Line\", \"ID Ref\", \"True Shipping Start Date\", \"True Start Date\", \"DateDifference\", \"FEATURE_DURATION_DAYS\", \"ERP Legacy Material ID\", \"SHIP_DATE\"}),\r\n  #\"Changed Type6\" = Table.TransformColumnTypes(#\"Removed columns\", {{\"FEATURE_RATE_PER_UOM\", Currency.Type}, {\"REQUIRED_ACCRUAL_RATE\", Currency.Type}, {\"FEATURE_PRICE_AMT_PER_CS_OR_AMT_PER_KG\", Currency.Type}, {\"FSP_OI_AMT_PER_CS_OR_AMT_PER_KG\", Currency.Type}, {\"REQUIRED_ACCRUAL_RATE_AMT_PER_KG\", Currency.Type}, {\"FSP_OI_AMT_PER_KG\", Currency.Type}}),\r\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Changed Type6\", {\"ORDER_END_DATE\", \"ORDER_START_DATE\", \"ERP Material ID\", \"SHIPPING_START_DATE\"}),\r\n  #\"Changed Type11\" = Table.TransformColumnTypes(#\"Removed columns 1\", {{\"Product_CS_LIFT\", Int64.Type}, {\"Duration\", Int64.Type}, {\"FEATURE_START_DATE\", type date}, {\"FEATURE_END_DATE\", type date}}),\r\n  #\"Added Custom5\" = Table.AddColumn(#\"Changed Type11\", \"Flag\", each 0),\r\n  #\"Removed Columns3\" = Table.RemoveColumns(#\"Added Custom5\", {\"FSP F\"}),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Removed Columns3\", {{\"Flag\", type text}}),\r\n  #\"Changed column type 1\" = Table.TransformColumnTypes(#\"Changed column type\", {{\"Flag\", Int64.Type}})\r\nin\r\n  #\"Changed column type 1\";\r\nshared Product_SHIP = let\r\n  Source = Product_DP,\r\n  #\"Filtered Rows2\" = Table.SelectRows(Source, each [ERP Distribution Channel] = \"RE\"),\r\n  #\"Renamed Columns4\" = Table.RenameColumns(#\"Filtered Rows2\", {{\"Year\", \"Ship Year\"}, {\"Week\", \"Ship Week\"}, {\"Feature Type\", \"Ad Mention\"}}),\r\n  #\"Changed Type7\" = Table.TransformColumnTypes(#\"Renamed Columns4\", {{\"Ship Year\", Int64.Type}, {\"Ship Week\", Int64.Type}}),\r\n  #\"Added Custom2\" = Table.AddColumn(#\"Changed Type7\", \"Week\", each [Ship Year]*100+[Ship Week]),\r\n  #\"Renamed Columns5\" = Table.RenameColumns(#\"Added Custom2\", {{\"Feature ID\", \"FeatureID\"}}),\r\n  #\"Filtered Rows3\" = Table.SelectRows(#\"Renamed Columns5\", each [FeatureID] <> null and [FeatureID] <> \"\"),\r\n  #\"Uppercased Text\" = Table.TransformColumns(#\"Filtered Rows3\",{{\"Product Banner\", Text.Upper}, {\"ERP Sales Office\", Text.Upper}}),\r\n  #\"Uppercased Text1\" = Table.TransformColumns(#\"Uppercased Text\",{{\"Product Banner\", Text.Upper, type text}}),\r\n  #\"Changed Type2\" = Table.TransformColumnTypes(#\"Uppercased Text1\", {{\"Week\", type text}}),\r\n  #\"Added Custom4\" = Table.AddColumn(#\"Changed Type2\", \"Product-KEY\", each [Product Banner] & \"-\" & [ERP Material ID] & \"-\" & [Week]),\r\n  #\"Filtered Rows5\" = Table.SelectRows(#\"Added Custom4\", each [Status] = \"Confirmed\"),\r\n  #\"Removed Duplicates1\" = Table.Distinct(#\"Filtered Rows5\", {\"Product-KEY\"}),\r\n  #\"Changed Type3\" = Table.TransformColumnTypes(#\"Removed Duplicates1\", {{\"Week\", Int64.Type}}),\r\n  #\"Filtered Rows1\" = Table.SelectRows(#\"Changed Type3\", each [#\"Product-KEY\"] <> null and [#\"Product-KEY\"] <> \"\"),\r\n  #\"Renamed Columns1\" = Table.RenameColumns(#\"Filtered Rows1\", {{\"LIFT_FORECAST_CS\", \"Product_CS_LIFT\"}, {\"ERP Units/Case\", \"Units Per Case\"}, {\"KILOS_PER_CASE\", \"Net Weight\"}}),\r\n  #\"Changed Type5\" = Table.TransformColumnTypes(#\"Renamed Columns1\", {{\"Product-KEY\", type text}}),\r\n  #\"Removed Columns2\" = Table.RemoveColumns(#\"Changed Type5\", {\"ENTERED_BY\", \"ERP Material\", \"Account Manager\", \"ERP Brand\", \"ERP Market\", \"ERP Department\", \"ERP Category\", \"ERP Segment\", \"REVISED_BY\"}),\r\n  #\"Removed Columns4\" = Table.RemoveColumns(#\"Removed Columns2\", {\"ERP Sales Office\", \"ERP Distribution Channel\", \"Ship Year\", \"Ship Week\", \"PER_UOM_FOR_INVOICE_COST\"}),\r\n  #\"Added Custom3\" = Table.AddColumn(#\"Removed Columns4\", \"Product_WEEKTYPE\", each \"SHIP\"),\r\n  #\"Changed Type10\" = Table.TransformColumnTypes(#\"Added Custom3\", {{\"Product_WEEKTYPE\", type text}}),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Changed Type10\", {{\"Product-KEY\", \"Product Key\"}, {\"Product_WEEKTYPE\", \"Product Week Type\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared PARTY_CALENDAR_WEEK = let\r\n  Source = PowerBI.Dataflows(),\r\n  Workspace = Source{[workspaceId = \"f45hs6s4-b642-4302-b3bf-436596af4ab0\"]}[Data],\r\n  Dataflow = Workspace{[dataflowId = \"ae9ed1b0-6a5e-4ae6-bf1f-742d21169d55\"]}[Data],\r\n  Entity = Dataflow{[entity = \"PARTY_CALENDAR_WEEK\"]}[Data]\r\nin\r\n  Entity;\r\nshared ERP_PRODUCT = let\r\n  Source = PowerBI.Dataflows(),\r\n  Workspace = Source{[workspaceId = \"f45hs6s4-b642-4302-b3bf-436596af4ab0\"]}[Data],\r\n  Dataflow = Workspace{[dataflowId = \"b3143130-f8a2-41b5-9d47-0eaddaa81b4c\"]}[Data],\r\n  Entity = Dataflow{[entity = \"ERP_PRODUCT\"]}[Data]\r\nin\r\n  Entity;\r\nshared ERP_REGIONAL = let\r\n  Source = PowerBI.Dataflows(),\r\n  Workspace = Source{[workspaceId = \"f45hs6s4-b642-4302-b3bf-436596af4ab0\"]}[Data],\r\n  Dataflow = Workspace{[dataflowId = \"b3143130-f8a2-41b5-9d47-0eaddaa81b4c\"]}[Data],\r\n  Entity = Dataflow{[entity = \"ERP_REGIONAL\"]}[Data]\r\nin\r\n  Entity;\r\nshared Product_DP_SRC = let\r\n  Source = PowerBI.Dataflows(),\r\n  Workspace = Source{[workspaceId = \"f45hs6s4-b642-4302-b3bf-436596af4ab0\"]}[Data],\r\n  Dataflow = Workspace{[dataflowId = \"3133805a-67eb-46bd-a961-ee649f58cdf4\"]}[Data],\r\n  Entity = Dataflow{[entity = \"Product_DP_SRC\"]}[Data]\r\nin\r\n  Entity;\r\nshared Product_RM_SRC = let\r\n  Source = PowerBI.Dataflows(),\r\n  Workspace = Source{[workspaceId = \"f45hs6s4-b642-4302-b3bf-436596af4ab0\"]}[Data],\r\n  Dataflow = Workspace{[dataflowId = \"3133805a-67eb-46bd-a961-ee649f58cdf4\"]}[Data],\r\n  Entity = Dataflow{[entity = \"Product_RM_SRC\"]}[Data]\r\nin\r\n  Entity;\r\n"},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"id\":\"ca8ed665-e229-4757-abd6-917e26555edb\",\"name\":\"LINKEDENTITIES\",\"description\":\"\",\"parentId\":null,\"order\":0},{\"id\":\"e85066e8-7fc1-41a8-834f-b90fcc0e4d9e\",\"name\":\"PARAMETERS\",\"description\":\"\",\"parentId\":null,\"order\":1}]"}],"entities":[{"$type":"LocalEntity","name":"Product_RM_T","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Product_RM_T.csv"},"attributes":[{"name":"FEATURE_ID","dataType":"string"},{"name":"BB_OI","dataType":"string"},{"name":"SKU_ERP","dataType":"string"},{"name":"SKU_LEGACY","dataType":"string"},{"name":"PRODUCT_DESCRIPTION","dataType":"string"},{"name":"PRODUCT_GROUP","dataType":"string"},{"name":"CBT","dataType":"string"},{"name":"CUSTOMER","dataType":"string"},{"name":"CUSTOMER_ID","dataType":"string"},{"name":"BANNER","dataType":"string"},{"name":"ACCOUNT_MANAGER","dataType":"string"},{"name":"MARKET","dataType":"string"},{"name":"DEPARTMENT","dataType":"string"},{"name":"CATEGORY","dataType":"string"},{"name":"UNITS_PER_CASE","dataType":"double"},{"name":"DATE_SUBMITTED","dataType":"date"},{"name":"SHIPPING_START_DATE","dataType":"date"},{"name":"FEATURE_START_DATE","dataType":"date"},{"name":"FEATURE_END_DATE","dataType":"date"},{"name":"SHIP_WEEK","dataType":"int64"},{"name":"TOTAL_INC_VOLUME","dataType":"double"},{"name":"AD_MENTION","dataType":"string"},{"name":"AD_SUPPORT","dataType":"string"},{"name":"PER_UOM_FOR_INVOICE_COST","dataType":"string"},{"name":"REGULAR_INVOICE_COST","dataType":"double"},{"name":"FEATURE_INVOICE_COST","dataType":"double"},{"name":"FSP","dataType":"double"},{"name":"OI_PORTION_PER_UOM","dataType":"double"},{"name":"PERCENT_SOLD_TO_BANNER","dataType":"double"},{"name":"FEATURE_RATE_PER_UOM","dataType":"double"},{"name":"FEATURE_RATE_UOM","dataType":"string"},{"name":"REQUIRED_ACCRUAL_RATE","dataType":"double"},{"name":"EST_TOTAL_AMT","dataType":"double"},{"name":"LIST_PRICE_AMT_PER_CS_OR_AMT_PER_KG","dataType":"double"},{"name":"FEATURE_PRICE_AMT_PER_CS_OR_AMT_PER_KG","dataType":"double"},{"name":"FSP_OI_AMT_PER_CS_OR_AMT_PER_KG","dataType":"double"},{"name":"OFF_STRATEGY_PRICING_CODE","dataType":"string"},{"name":"FEATURE_STATUS","dataType":"string"},{"name":"OPENING_STATUS","dataType":"double"},{"name":"CLOSING_STATUS","dataType":"double"},{"name":"PRICING_EXCEPTION","dataType":"string"},{"name":"PRICING_MGR_APPROVAL","dataType":"string"},{"name":"PRICING_EXCEPTION_APPROVAL_DATE","dataType":"string"},{"name":"MARKETING_NAME","dataType":"string"},{"name":"MARKETING_APPROVED_DATE","dataType":"date"},{"name":"TP","dataType":"string"},{"name":"INSERT_DATE","dataType":"date"},{"name":"TIMESTAMP","dataType":"dateTime"},{"name":"MergeTag","dataType":"string"},{"name":"Year","dataType":"int64"},{"name":"ERP Distribution Channel","dataType":"string"}],"partitions":[{"name":"FullRefreshPolicyPartition","refreshTime":"2021-06-29T14:37:01.1434292+00:00","location":"https://wabincusdpcdERP1.blob.core.windows.net:443/f45bc06b-b172-4846-b72a-75d6663b9d4a/Product_RM_T.csv?snapshot=2021-06-29T14%3A37%3A01.0970909Z"}]}]}